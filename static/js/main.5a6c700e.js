webpackJsonp([1],{Lhif:function(e,t,n){"use strict";var a=n("/5Fv");var r=n.n(a);var i=n("Z8+D");var l=n.n(i);var u=n("5wBM");var c=n.n(u);var o=n("1hLZ");var s=n.n(o);var p=n("fqFk");var f=n.n(p);var v=n("+k99");var y=n.n(v);var d=n("XCT1");var m=n.n(d);var h=n("kUpb");var b=n.n(h);var E=n("7vLJ");var g=n.n(E);var k=n("SYKI");var q=n("GO17");var D=n.n(q);var w=n("IwDa");var I=n.n(w);var O=n("KVot");var x=n.n(O);var P=n("SMMq");var j=n.n(P);var S=n("SCI0");var _=n.n(S);var B=n("jIU4");var C=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}return function(t,n,a){if(n)e(t.prototype,n);if(a)e(t,a);return t}}();function T(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++){n[t]=e[t]}return n}else{return Array.from(e)}}function W(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function M(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function R(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var A=b.a.Header,L=b.a.Content;var N=y.a.TabPane;var G=function(e){R(t,e);function t(e){W(this,t);var n=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.state={notDealPay:[],notDealSell:[],tradingDetail:[],currentIndex:0};return n}C(t,[{key:"componentWillMount",value:function e(){var t=this;window.setInterval(function(){fetch("/listOrders?start=0&size=100",{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){var n=t.state.currentIndex;if(n<(e.length&&e.length))t.renderPlaceOrder(e)}).catch(function(e){console.info("error",e)})},2e3)}},{key:"sortDatas",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;t.sort(function(e,t){if(e.price>t.price){return-1*n}if(e.price<t.price){return 1*n}if(e.price===t.price){return e.number-t.number}return 0});return t}},{key:"getDateT",value:function e(){return(new Date).toLocaleString()}},{key:"renderPlaceOrder",value:function e(t){var n=this;var a=this.state.tradingDetail;var r=[];var i=[];var l=[];var u=[];var c=[];var o=[];var s=this.state,p=s.notDealPay,f=s.notDealSell,v=s.currentIndex;[].concat(T(p),T(f),T(t.slice(v))).map(function(e,t){e.key=t;if(e.side==="bid"){r.push(e)}else{i.push(e)}return null});l=this.sortDatas(r);u=this.sortDatas(i,-1);l.map(function(e,t){u.map(function(r,i){if(e.quantity>0&&e.price>r.price){if(r.quantity>0){a.unshift({price:(e.price+r.price)/2,date:n.getDateT(),pay:Object.assign({},l[t]),sell:Object.assign({},u[i])});if(e.quantity>=r.quantity){l[t].quantity=e.quantity-r.quantity;u[i].quantity=0}else{l[t].quantity=0;u[i].quantity=r.quantity-e.quantity}}}})});c=l.filter(function(e){return e.quantity>0});o=u.filter(function(e){return e.quantity>0});a.map(function(e,t){e.key=t;e.number=t});this.setState({notDealPay:c,notDealSell:this.sortDatas(o),tradingDetail:a,currentIndex:t.length})}},{key:"getBodyWrapper",value:function e(t){return g.a.createElement(D.a,{transitionName:"move",component:"tbody",className:t.props.className},t.props.children)}},{key:"expandedRowRender",value:function e(t){return g.a.createElement("div",null,g.a.createElement("p",null,"买方（bid）: "),g.a.createElement("span",null,"number: ",t.pay.number," /"),g.a.createElement("span",null," price: ",t.pay.price," /"),g.a.createElement("span",null," quantity: ",t.pay.quantity," "),g.a.createElement("p",null,"卖方（ask）: "),g.a.createElement("span",null,"number: ",t.sell.number," /"),g.a.createElement("span",null," price: ",t.sell.price," /"),g.a.createElement("span",null," quantity: ",t.sell.quantity," "))}},{key:"render",value:function e(){var t=this.state,n=t.notDealPay,a=t.notDealSell,r=t.tradingDetail;var i=n.slice(0,20);var u=a.slice(0,20);var c=r.slice(0,30);return g.a.createElement(b.a,{className:"my-layout"},g.a.createElement(A,null,g.a.createElement("h2",null,"证券交易市场")),g.a.createElement(L,null,g.a.createElement(l.a,{gutter:16},g.a.createElement(s.a,{md:12},g.a.createElement(y.a,{defaultActiveKey:"1"},g.a.createElement(N,{tab:"买单(bid) "+i.length+"条记录",key:"1"},g.a.createElement(k["a"],{columns:B["a"],data:i,getBodyWrapper:this.getBodyWrapper})),g.a.createElement(N,{tab:"卖单(ask) "+i.length+"条记录",key:"2"},g.a.createElement(k["a"],{columns:B["a"],data:u,getBodyWrapper:this.getBodyWrapper})))),g.a.createElement(s.a,{md:12},g.a.createElement(k["a"],{columns:B["b"],data:c,getBodyWrapper:this.getBodyWrapper,expandedRowRender:this.expandedRowRender,title:function e(t){return g.a.createElement("div",null,"成交队列: ",t.length,"条记录 ")}})))))}}]);return t}(E["Component"]);t["a"]=G},SCI0:function(e,t){},hqmG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=n("7vLJ");var r=n.n(a);var i=n("ap4E");var l=n.n(i);var u=n("wKi/");var c=n.n(u);var o=n("Lhif");var s=function e(t){n.i(i["render"])(r.a.createElement(u["AppContainer"],null,r.a.createElement(t,null)),document.getElementById("root"))};s(o["a"]);if(false){e.hot.accept("./script/Main",function(){s(Main)})}},jIU4:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});var a=[{title:"Number",dataIndex:"number",key:"number"},{title:"Price",dataIndex:"price",key:"price",sorter:function e(t,n){return t.price-n.price}},{title:"Quantity",dataIndex:"quantity",key:"quantity"}];var r=[{title:"Number",dataIndex:"number",key:"number"},{title:"Price",dataIndex:"price",key:"price"},{title:"Date",dataIndex:"date",key:"date"}]}},["hqmG"]);